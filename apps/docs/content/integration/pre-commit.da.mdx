---
title: pre-commit
description: Kør Ultracite automatisk på dine staged Git-filer med pre-commit
---

Ultracite tilbyder sømløs integration med [pre-commit](https://pre-commit.com/), et populært Python-baseret framework til håndtering af Git hooks. Denne integration opsætter automatisk pre-commit hooks, så din kode bliver korrekt formateret før hvert commit.

## Hvad er pre-commit?

pre-commit er et framework til at administrere og vedligeholde multi-sprog pre-commit hooks. Det er udbredt i Python-økosystemet, men understøtter hooks for alle sprog. pre-commit bruger en `.pre-commit-config.yaml`-fil til at definere, hvilke hooks der skal køres, og hvornår.

## Hvordan Ultracite bruger pre-commit

Når du initialiserer Ultracite i dit projekt, kan det automatisk konfigurere pre-commit til at køre kodeformatering før hvert commit. Dette sikrer, at:

- Al committet kode følger konsekvente formateringsstandarder
- Kvalitetskontroller af kode håndhæves automatisk
- Teammedlemmer ikke behøver at huske at formatere kode manuelt
- Dit repository bevarer en ren og konsekvent kodestil

## Pre-commit Hook-adfærd

Ultracites pre-commit-integration opretter en lokal hook, der kører følgende kommando:

```bash
npx ultracite fix
```

Denne kommando:
- Kører Biome's linter og formateringsværktøj på din kodebase
- Retter automatisk formateringsproblemer, hvor det er muligt
- Sikrer, at alle staged filer opfylder dit projekts kodestandarder
- Forhindrer commits, der ville indføre formateringsinkonsekvenser

## Automatisk opsætning

Under initialiseringsprocessen (`ultracite init`), hvis du vælger pre-commit muligheden, gør Ultracite følgende:

1. **Opretter konfigurationsfil**: Opsætter `.pre-commit-config.yaml`-filen med Ultracite-hooken
2. **Håndterer eksisterende opsætninger**: Hvis du allerede har pre-commit konfigureret, tilføjer den Ultracite-hooken til din eksisterende konfiguration i stedet for at overskrive den

## Genereret konfiguration

Ultracite genererer følgende `.pre-commit-config.yaml`:

```yaml
repos:
  - repo: local
    hooks:
      - id: ultracite
        name: ultracite
        entry: npx ultracite fix
        language: system
        types_or: [javascript, jsx, ts, tsx, json, css]
        pass_filenames: false
```

### Forklaring af konfigurationen

- **repo: local** - Bruger en lokalt defineret hook i stedet for at hente fra et fjernlager
- **id: ultracite** - Unikt id for hooken
- **name: ultracite** - Visningsnavn, der vises, når hooken kører
- **entry** - Kommandoen der eksekveres (bruger npx til at køre Ultracite)
- **language: system** - Bruger systemets installerede værktøjer
- **types_or** - Filtyper, der udløser hooken
- **pass_filenames: false** - Kører én gang for alle filer i stedet for per-fil

## Forudsætninger

Før du bruger pre-commit integrationen, skal du have:

1. **Python installeret** - pre-commit er et Python-pakke
2. **pre-commit installeret** - Installer globalt eller i et virtuelt miljø:
   ```bash
   pip install pre-commit
   # or
   pipx install pre-commit
   ```
3. **Initialiser hooks** - Efter Ultracite opretter konfigurationen, kør:
   ```bash
   pre-commit install
   ```

## Fordele

### Konsistent kodestil
Hvert commit følger automatisk dit projekts formateringsstandarder og eliminerer stil-debatter og inkonsekvenser.

### Automatisk kvalitetskontrol
Find formateringsproblemer før de kommer ind i dit repository og oprethold en ren commit-historik.

### Team-samarbejde
Alle teammedlemmer følger automatisk de samme formateringsstandarder uden manuel indgriben.

### CI/CD-optimering
Reducer CI/CD-pipeline-fejl på grund af formateringsproblemer, da koden er forformateret lokalt.

### Multi-sprog support
Hvis dit projekt bruger flere sprog, kan pre-commit håndtere hooks for dem alle i én konfigurationsfil.

## Integration i arbejdsgangen

Med pre-commit integration aktiveret bliver din typiske Git-arbejdsgang:

1. **Foretag ændringer** i dine kodefiler
2. **Stage ændringer** med `git add`
3. **Commit ændringer** med `git commit`
4. **Pre-commit hook kører** automatisk og formaterer staged filer
5. **Commit fortsætter** med korrekt formateret kode

Hvis formatteren foretager ændringer, skal du stage og committe disse ændringer også.

## Tilpasning

Mens Ultracite sætter fornuftige standarder, kan du tilpasse adfærden:

- Tilføj yderligere hooks fra [pre-commit hooks-arkivet](https://pre-commit.com/hooks.html)
- Konfigurer Biome-indstillinger for at justere formateringsregler
- Ændr `types_or` filteret for at inkludere/ekskludere filtyper
- Tilføj `exclude` mønstre for at springe visse filer over

### Eksempel på udvidet konfiguration

```yaml
repos:
  - repo: local
    hooks:
      - id: ultracite
        name: ultracite
        entry: npx ultracite fix
        language: system
        types_or: [javascript, jsx, ts, tsx, json, css]
        pass_filenames: false
        exclude: ^(vendor/|dist/)
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
```

## Fejlfinding

### Hooken kører ikke
Hvis pre-commit hooken ikke kører:
- Sørg for at pre-commit er installeret: `pre-commit --version`
- Kør `pre-commit install` for at sætte Git hooks op
- Tjek at `.pre-commit-config.yaml` findes i dit projektrod

### Node.js ikke fundet
Hvis du får fejl om, at npx ikke findes:
- Sørg for, at Node.js er i din PATH
- Overvej at bruge en `.nvmrc` eller `.node-version` fil til versionstyring

### Omgå hooks
I sjældne tilfælde hvor du skal springe pre-commit hooken over:
```bash
git commit --no-verify
# or
git commit -n
```

Brug dette sparsomt, da det omgår den automatiske formatering, som holder din kodebase konsekvent.

### Køre hooks manuelt
For at køre hooks manuelt på alle filer:
```bash
pre-commit run --all-files
```

For kun at køre Ultracite-hooken:
```bash
pre-commit run ultracite --all-files
```
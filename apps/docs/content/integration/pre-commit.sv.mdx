---
title: pre-commit
description: Kör Ultracite automatiskt på dina stagade Git-filer med pre-commit
---

Ultracite erbjuder sömlös integration med [pre-commit](https://pre-commit.com/), ett populärt Python-baserat ramverk för att hantera Git-hooks. Denna integration ställer automatiskt in pre-commit-hooks för att säkerställa att din kod är korrekt formaterad innan varje commit.

## Vad är pre-commit?

pre-commit är ett ramverk för att hantera och underhålla flerspråkiga pre-commit-hooks. Det används i stor utsträckning i Python-ekosystemet men stöder hooks för alla språk. pre-commit använder en `.pre-commit-config.yaml`-fil för att definiera vilka hooks som ska köras och när.

## Hur Ultracite använder pre-commit

När du initierar Ultracite i ditt projekt kan det automatiskt konfigurera pre-commit för att köra kodformatering före varje commit. Detta säkerställer att:

- All committad kod följer konsekventa formatkrav
- Kodkvalitetskontroller genomförs automatiskt
- Teammedlemmar slipper komma ihåg att formatera kod manuellt
- Ditt repository behåller en ren, konsekvent kodstil

## Pre-commit-hookens beteende

Ultracites pre-commit-integration skapar en lokal hook som kör följande kommando:

```bash
npx ultracite fix
```

Detta kommando:
- Kör Biomes linter och formatterare på din kodbas
- Fixar automatiskt formateringsproblem där det är möjligt
- Säkerställer att alla stagade filer uppfyller ditt projekts kodstandarder
- Förhindrar commits som skulle införa formateringsinkonsekvenser

## Automatisk konfiguration

Under initialiseringsprocessen (`ultracite init`), om du väljer pre-commit-alternativet, så gör Ultracite följande:

1. **Skapar konfigurationsfil**: Skapar `.pre-commit-config.yaml` med Ultracite-hooken
2. **Hanterar befintliga inställningar**: Om du redan har pre-commit konfigurerat så lägger det till Ultracite-hooken i din befintliga konfiguration istället för att skriva över den

## Genererad konfiguration

Ultracite genererar följande `.pre-commit-config.yaml`:

```yaml
repos:
  - repo: local
    hooks:
      - id: ultracite
        name: ultracite
        entry: npx ultracite fix
        language: system
        types_or: [javascript, jsx, ts, tsx, json, css]
        pass_filenames: false
```

### Konfiguration förklarad

- **repo: local** - Använder en lokalt definierad hook istället för att hämta från ett fjärrförråd
- **id: ultracite** - Unik identifierare för hooken
- **name: ultracite** - Visningsnamn som visas när hooken körs
- **entry** - Kommandot som ska köras (använder npx för att köra Ultracite)
- **language: system** - Använder systemets installerade verktyg
- **types_or** - Filtyper som triggar hooken
- **pass_filenames: false** - Körs en gång för alla filer istället för per fil

## Förutsättningar

Innan du använder pre-commit-integrationen behöver du:

1. **Python installerat** - pre-commit är ett Python-paket
2. **pre-commit installerat** - Installera globalt eller i ett virtuellt miljö:
   ```bash
   pip install pre-commit
   # or
   pipx install pre-commit
   ```
3. **Initiera hooks** - Efter att Ultracite har skapat konfigurationen, kör:
   ```bash
   pre-commit install
   ```

## Fördelar

### Konsekvent kodstil
Varje commit följer automatiskt ditt projekts formatregler, vilket eliminerar stildebatter och inkonsekvenser.

### Automatiserad kvalitetskontroll
Upptäck formateringsproblem innan de kommer in i ditt repository och behåll en ren commit-historik.

### Teamsamarbete
Alla teammedlemmar följer automatiskt samma formatregler utan manuell inblandning.

### CI/CD-optimering
Minska CI/CD-pipelinefel på grund av formateringsproblem, eftersom koden förformateras lokalt.

### Stöd för flera språk
Om ditt projekt använder flera språk kan pre-commit hantera hooks för alla i en och samma konfigurationsfil.

## Integrering i arbetsflödet

Med pre-commit-integration aktiverad blir ditt vanliga Git-arbetsflöde:

1. Gör ändringar i dina kodfiler
2. Staga ändringarna med `git add`
3. Commit:a ändringarna med `git commit`
4. Pre-commit-hooken körs automatiskt och formaterar de stagade filerna
5. Commit fortsätter med korrekt formaterad kod

Om formatteraren gör ändringar måste du lägga till och commit:a dessa ändringar också.

## Anpassning

Medan Ultracite sätter upp rimliga standarder kan du anpassa beteendet:

- Lägg till ytterligare hooks från [förrådet för pre-commit hooks](https://pre-commit.com/hooks.html)
- Konfigurera Biome-inställningar för att justera formateringsregler
- Modifiera filtret `types_or` för att inkludera/exkludera filtyper
- Lägg till `exclude`-mönster för att hoppa över vissa filer

### Exempel på utökad konfiguration

```yaml
repos:
  - repo: local
    hooks:
      - id: ultracite
        name: ultracite
        entry: npx ultracite fix
        language: system
        types_or: [javascript, jsx, ts, tsx, json, css]
        pass_filenames: false
        exclude: ^(vendor/|dist/)
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
```

## Felsökning

### Hook körs inte
Om pre-commit-hooken inte körs:
- Säkerställ att pre-commit är installerat: `pre-commit --version`
- Kör `pre-commit install` för att ställa in Git-hooks
- Kontrollera att `.pre-commit-config.yaml` finns i projektets rot

### Node.js hittades inte
Om du får fel om att npx inte hittas:
- Säkerställ att Node.js finns i din PATH
- Överväg att använda en `.nvmrc` eller `.node-version`-fil för versionshantering

### Hoppa över hooks
I sällsynta fall där du behöver kringgå pre-commit-hooken:
```bash
git commit --no-verify
# or
git commit -n
```

Använd detta sparsamt, eftersom det kringgår den automatiska formateringen som håller din kodbas konsekvent.

### Köra hooks manuellt
För att köra hooks manuellt på alla filer:
```bash
pre-commit run --all-files
```

För att bara köra Ultracite-hooken:
```bash
pre-commit run ultracite --all-files
```
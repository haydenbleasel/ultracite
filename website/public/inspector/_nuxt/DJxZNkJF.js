import{s as ie,_ as ae,a as ne,b as ue,F as re,c as ce}from"./DwX90mX3.js";import{g as Y,_ as de,a as le}from"./C8mEIphS.js";import{_ as pe}from"./CUiVfWy_.js";import{f as X,m as Z,g as fe,r as N,h as se,i as he,j as P,k as ge,o as n,c as i,a as e,t as d,n as R,l as T,b as k,F as p,q as S,s as f,v as ve,x as s,w as ee,y as E,z as me,A as z,d as V,B as _e,C as be,D as r,E as te,G as O,H as b,I as ye,J as ke,K as xe,L as $e,M as F,N as we,O as Ce,P as G,Q,R as oe,S as Oe,T as je,U as W}from"./Dio59dAG.js";const Me=["open"],Fe={block:""},Re={class:"absolute right-[calc(100%+10px)] top-1.5","text-right":"","font-mono":"",op35:"","lt-lg:hidden":""},Ie={flex:"~ gap-2 items-center","cursor-pointer":"","select-none":"","bg-hover":"",px2:"",py2:"","text-sm":"","font-mono":""},Se=e("div",{class:"[details[open]_&]:rotate-90","i-ph-caret-right":"","flex-none":"",op50:"",transition:""},null,-1),Te={flex:"","flex-auto":"","flex-col":"","flex-wrap":"","gap-3":"","md:flex-row":"","md:justify-end":""},Ee={key:1},De={flex:"~ gap-2 items-start"},Ae={"pointer-events-none":"",absolute:"","right-2":"","top-2":"","text-right":"","text-5em":"","font-mono":"",op5:""},Be={key:0,flex:"~ col gap-4","of-auto":"",px4:"",py3:""},Ge={key:0,flex:"~ gap-2 items-start"},Ne=e("div",{"i-ph-file-magnifying-glass-duotone":"",my1:"","flex-none":""},null,-1),Pe={flex:"~ col gap-2"},ze=e("div",null,"Applies to files matching",-1),Ve={flex:"~ gap-2 items-center wrap"},Le={key:1,flex:"~ gap-2 items-center"},Ue=e("div",{"i-ph-files-duotone":"","flex-none":""},null,-1),qe=e("div",null,"Generally applies to all files",-1),Ke=[Ue,qe],He={key:2,flex:"~ gap-2 items-start"},Je=e("div",{"i-ph-plug-duotone":"",my1:"","flex-none":""},null,-1),Qe={flex:"~ col gap-2"},We={flex:"~ gap-2 items-center wrap"},Xe=["onClick"],Ye={key:3,flex:"~ gap-2 items-start"},Ze=e("div",{"i-ph-eye-closed-duotone":"",my1:"","flex-none":""},null,-1),et={flex:"~ col gap-2"},tt={key:0},ot={key:1},nt={flex:"~ gap-2 items-center wrap"},lt={key:4},st={flex:"~ gap-2 items-center"},it=e("div",{"i-ph-list-dashes-duotone":"",my1:"","flex-none":""},null,-1),at=["onClick"],ut=e("div",{"i-ph-funnel-duotone":""},null,-1),rt={key:5,flex:"~ gap-2"},ct=e("div",{"i-ph-sliders-duotone":"",my1:"","flex-none":""},null,-1),dt={flex:"~ col gap-2","w-full":""},pt=e("div",null," Additional configurations ",-1),ft={"of-auto":"",p2:"",px3:"",op50:""},ht=X({__name:"ConfigItem",props:Z({config:{},index:{},filters:{},active:{type:Boolean},matchedGlobs:{}},{open:{default:!0},openModifiers:{}}),emits:Z(["badgeClick"],["update:open"]),setup(L,{emit:x}){const U=L,D=x,y=fe(L,"open"),$=N(y.value);if(!$.value){const t=se(()=>{y.value&&($.value=!0,t())})}const q=he();function j(t){be.plugin=t,q.push("/rules")}const v=P(()=>{const t=["files","plugins","ignores","rules","name","index"];return Object.fromEntries(Object.entries(U.config).filter(([C])=>!t.includes(C)))});return(t,C)=>{var o,m,g,_;const K=de,M=pe,h=le,H=ae,A=ne,B=ue,c=ge("close-popper");return n(),i("details",{class:R(["flat-config-item",t.active?"border-yellow:70":"border-base"]),open:y.value,border:"~ rounded-lg",relative:"",onToggle:C[1]||(C[1]=l=>y.value=l.target.open)},[e("summary",Fe,[e("div",Re," #"+d(t.index+1),1),e("div",Ie,[Se,e("div",Te,[e("span",{class:R(t.config.name?"":"op50 italic"),"flex-1":""},[t.config.name?(n(),T(K,{key:0,name:t.config.name},null,8,["name"])):(n(),i("span",Ee,"anonymous #"+d(t.index+1),1))],2),e("div",De,[k(M,{icon:"i-ph-file-magnifying-glass-duotone",number:((o=t.config.files)==null?void 0:o.length)||0,color:"text-yellow5",title:"Files"},null,8,["number"]),k(M,{icon:"i-ph-eye-closed-duotone",number:((m=t.config.ignores)==null?void 0:m.length)||0,color:"text-purple5 dark:text-purple4",title:"Ignores"},null,8,["number"]),k(M,{icon:"i-ph-sliders-duotone",number:Object.keys(v.value).length,color:"text-green5",title:"Options"},null,8,["number"]),k(M,{icon:"i-ph-plug-duotone",number:Object.keys(t.config.plugins||{}).length,color:"text-teal5",title:"Plugins"},null,8,["number"]),k(M,{icon:"i-ph-list-dashes-duotone",number:Object.keys(t.config.rules||{}).length,color:"text-blue5 dark:text-blue4",title:"Rules","mr-2":""},null,8,["number"])])])])]),e("div",Ae," #"+d(t.index+1),1),$.value?(n(),i("div",Be,[t.config.files?(n(),i("div",Ge,[Ne,e("div",Pe,[ze,e("div",Ve,[(n(!0),i(p,null,S((g=t.config.files)==null?void 0:g.flat(),(l,u)=>{var a;return n(),T(h,{key:u,glob:l,popup:"files",active:(a=t.matchedGlobs)==null?void 0:a.includes(l)},null,8,["glob","active"])}),128))])])])):t.config.rules||Object.keys(v.value).length?(n(),i("div",Le,Ke)):f("",!0),t.config.plugins?(n(),i("div",He,[Je,e("div",Qe,[e("div",null,"Plugins ("+d(Object.keys(t.config.plugins).length)+")",1),e("div",We,[(n(!0),i(p,null,S(Object.keys(t.config.plugins),(l,u)=>(n(),i("button",{key:u,border:"~ base rounded-full",px3:"",style:ve({color:("getPluginColor"in t?t.getPluginColor:s(Y))(l),backgroundColor:("getPluginColor"in t?t.getPluginColor:s(Y))(l,.1)}),"font-mono":"",onClick:a=>j(l)},d(l),13,Xe))),128))])])])):f("",!0),t.config.ignores?(n(),i("div",Ye,[Ze,e("div",et,[t.config.files?(n(),i("div",ot," Ignore ")):(n(),i("div",tt," Ignore files globally ")),e("div",nt,[(n(!0),i(p,null,S(t.config.ignores,(l,u)=>{var a;return n(),T(h,{key:u,glob:l,active:(a=t.matchedGlobs)==null?void 0:a.includes(l)},null,8,["glob","active"])}),128))])])])):f("",!0),t.config.rules&&Object.keys(t.config.rules).length?(n(),i("div",lt,[e("div",st,[it,e("div",null,"Rules ("+d(Object.keys(t.config.rules).length)+")",1)]),k(A,{py2:"",class:R(s(_e)?"pl6":""),rules:t.config.rules,filter:l=>{var u;return!((u=t.filters)!=null&&u.rule)||t.filters.rule===l},"get-bind":l=>{var u;return{class:s(E)((u=t.config.rules)==null?void 0:u[l])==="off"?"op50":""}}},{popup:ee(({ruleName:l,value:u})=>[k(H,{border:"t base","is-local":!0,state:{name:l,level:s(E)(u),configIndex:t.index,options:s(me)(u)}},null,8,["state"])]),"popup-actions":ee(({ruleName:l})=>[z((n(),i("button",{"btn-action-sm":"",onClick:u=>D("badgeClick",l)},[ut,V(" Filter by this rule ")],8,at)),[[c]])]),_:1},8,["class","rules","filter","get-bind"]),e("div",null,[(_=t.filters)!=null&&_.rule?(n(),i("button",{key:0,ml8:"",op50:"",onClick:C[0]||(C[0]=l=>D("badgeClick",""))}," ..."+d(Object.keys(t.config.rules).filter(l=>{var u;return l!==((u=t.filters)==null?void 0:u.rule)}).length)+" others rules are hidden ",1)):f("",!0)])])):f("",!0),Object.keys(v.value).length?(n(),i("div",rt,[ct,e("div",dt,[pt,(n(!0),i(p,null,S(v.value,(l,u)=>(n(),i("div",{key:u,border:"~ base rounded-lg"},[e("div",ft,d(u),1),k(B,{lang:"ts",code:s(ie)(l),"max-h-100":"","max-w-full":"","w-full":"","of-scroll":"",rounded:"","bg-code":"",p2:"","text-sm":""},null,8,["code"])]))),128))])])):f("",!0)])):f("",!0)],42,Me)}}}),gt={flex:"~ col gap-3",py4:""},vt={relative:"",flex:""},mt=e("div",{absolute:"","bottom-0":"","left-0":"","top-0":"",flex:"~ items-center justify-center",p4:"",op50:""},[e("div",{"i-ph-magnifying-glass-duotone":""})],-1),_t={pos:"absolute left-8 right-8 top-1/1",border:"~ base rounded",flex:"~ col","z-1":"","mt--1":"","max-h-80":"","of-auto":"",py1:"",shadow:"","bg-glass":""},bt=["onClick"],yt={key:0,flex:"~ gap-2 items-center wrap",mb2:""},kt={key:0},xt=e("div",{"i-ph-file-dotted-duotone":"","text-purple":""},null,-1),$t=e("span",{op50:""},"Filepath",-1),wt={key:0,op50:""},Ct=e("span",{op50:""},"matched with",-1),Ot=e("span",{op50:""},"config items",-1),jt=e("span",{op50:""},"matched with total ",-1),Mt=e("span",{op50:""},"rules, ",-1),Ft=e("span",{op50:""},"of them are specific to the file",-1),Rt={key:1},It={flex:"~ gap-2 items-center",border:"~ blue/20 rounded-full","bg-blue:10":"",px3:"",py1:""},St=e("div",{"i-ph-funnel-duotone":""},null,-1),Tt=e("span",{op50:""},"Filtered by",-1),Et=e("span",{op50:""},"rule",-1),Dt={flex:"~ gap-2 items-center wrap"},At={key:0,border:"~ base rounded",flex:""},Bt=e("div",{"i-ph-stack-duotone":""},null,-1),Gt=e("span",null,"Matched Config Items",-1),Nt=[Bt,Gt],Pt=e("div",{border:"l base"},null,-1),zt=e("div",{"i-ph-film-script-duotone":""},null,-1),Vt=e("span",null,"Merged Rules",-1),Lt=[zt,Vt],Ut={key:1,flex:"~ gap-2 items-center",ml2:"","select-none":""},qt=["checked"],Kt=e("span",{op50:""},"Show Specific Rules Only",-1),Ht=e("div",{"flex-auto":""},null,-1),Jt=e("div",{mt5:"",italic:"",op50:""}," No matched config items. ",-1),Qt=e("div",null,"Ignored by globs:",-1),Wt={flex:"~ gap-2 items-center wrap"},Xt={class:"flat-config-item",border:"~ base rounded-lg",relative:""},Yt={block:""},Zt={flex:"~ gap-2 items-start","cursor-pointer":"","select-none":"","bg-hover":"",px2:"",py2:"","text-sm":"","font-mono":"",op75:""},eo=e("div",{"i-ph-caret-right":"",class:"[details[open]_&]:rotate-90",transition:""},null,-1),to={class:"flat-config-item",border:"~ base rounded-lg",open:"",relative:""},oo={block:""},no={flex:"~ gap-2 items-start","cursor-pointer":"","select-none":"","bg-hover":"",px2:"",py2:"","text-sm":"","font-mono":"",op75:""},lo=e("div",{"i-ph-caret-right":"",class:"[details[open]_&]:rotate-90",transition:""},null,-1),so={px4:"",pt4:""},io={px4:"",pt4:""},po=X({__name:"configs",setup(L){const x=N(r.filepath);function U(){F.value=F.value.map(()=>!0)}function D(){F.value=F.value.map(()=>!1)}const y=te([]),$=te(null);se(()=>{let c=O.value.configs;r.filepath?($.value=Oe(r.filepath,O.value.configs,O.value.configsIgnoreOnly),$.value.configs.length?c=Array.from(new Set([...$.value.configs,...O.value.configsGeneral.filter(o=>!je(o)).map(o=>o.index)])).sort().map(o=>O.value.configs[o]):c=[]):$.value=null,r.rule&&(c=c.filter(o=>r.rule in(o.rules||{}))),y.value=c});const q=P(()=>{var c;return new re(((c=O.value.filesResolved)==null?void 0:c.list)||[],{threshold:.3,includeMatches:!0})}),j=P(()=>q.value.search(r.filepath||"")),v=N(0),t=N(!1);function C(c=v.value){var o;t.value&&(x.value=r.filepath=((o=j.value[c])==null?void 0:o.item)||r.filepath,t.value=!1)}function K(){setTimeout(()=>{t.value=!1},100)}function M(c){t.value&&(v.value+=c,v.value<0&&(v.value+=j.value.length),v.value>=j.value.length&&(v.value-=j.value.length))}const h=P(()=>{if(!r.filepath||b.value.viewFileMatchType!=="merged")return{all:{},common:{},specific:{},specificDisabled:{},specificEnabled:{}};const c={},o={},m={};y.value.forEach(l=>{l.rules&&(Object.assign(c,l.rules),l.files?Object.assign(m,l.rules):Object.assign(o,l.rules))});const g=Object.fromEntries(Object.entries(m).filter(([l,u])=>E(u)==="off")),_=Object.fromEntries(Object.entries(m).filter(([l,u])=>E(u)!=="off"));for(const l in c)E(c[l])==="off"&&delete c[l];return{all:c,common:o,specific:m,specificDisabled:g,specificEnabled:_}}),H=X({props:{matches:Array},setup(c){return()=>{var o;return(o=c.matches)==null?void 0:o.map(m=>{let g=0;const _=m.value||"",l=[];for(const[u,a]of m.indices)g<u&&l.push(W("span",{class:"op50"},_.slice(g,u))),l.push(W("span",{class:"text-purple font-bold"},_.slice(u,a+1))),g=a+1;return g<_.length&&l.push(W("span",{class:"op50"},_.slice(g))),l})}}});ye(()=>x.value,()=>{r.filepath=x.value,v.value=0},{debounce:200}),ke(()=>r.filepath,()=>{r.filepath!==x.value&&(x.value=r.filepath)},{flush:"sync"});const A=new Map,B=xe();return $e(async()=>{var c;if(B.query.index!=null){const o=Number(B.query.index)-1;F.value=F.value.map((m,g)=>g===o),await we(),(c=A.get(o))==null||c.scrollIntoView({behavior:"smooth",block:"start"})}}),(c,o)=>{var u;const m=ce,g=le,_=ne,l=ht;return n(),i("div",null,[e("div",gt,[e("div",vt,[z(e("input",{"onUpdate:modelValue":o[0]||(o[0]=a=>x.value=a),placeholder:"Test matching with filepath...",border:"~ base rounded-full",class:R(x.value?"font-mono":""),"w-full":"","bg-transparent":"",px3:"",py2:"",pl10:"","outline-none":"",onFocus:o[1]||(o[1]=a=>t.value=!0),onClick:o[2]||(o[2]=a=>t.value=!0),onBlur:K,onKeydown:[o[3]||(o[3]=G(a=>t.value=!1,["esc"])),o[4]||(o[4]=G(Q(a=>M(1),["prevent"]),["down"])),o[5]||(o[5]=G(Q(a=>M(-1),["prevent"]),["up"])),o[6]||(o[6]=G(Q(a=>C(),["prevent"]),["enter"]))]},null,34),[[Ce,x.value]]),mt,z(e("div",_t,[(n(!0),i(p,null,S(j.value,(a,w)=>(n(),i("button",{key:a.item,class:R(w===v.value?"bg-active":""),"hover:bg-active":"",px3:"","py0.5":"","text-left":"","font-mono":"",onClick:J=>C(w)},[a.matches?(n(),T(s(H),{key:0,matches:a.matches},null,8,["matches"])):(n(),i(p,{key:1},[V(d(a.item),1)],64))],10,bt))),128))],512),[[oe,t.value&&j.value.length]])]),s(r).filepath||s(r).rule?(n(),i("div",yt,[s(r).filepath?(n(),i("div",kt,[e("div",{flex:"~ gap-2 items-center wrap",border:"~ purple/20 rounded-full","bg-purple:10":"",px3:"",py1:"",class:R({"saturate-0":!y.value.length})},[xt,$t,e("code",null,d(s(r).filepath),1),y.value.length?s(b).viewFileMatchType==="configs"?(n(),i(p,{key:1},[Ct,e("span",null,d(y.value.length)+" / "+d(s(O).configs.length),1),Ot],64)):(n(),i(p,{key:2},[jt,e("span",null,d(Object.keys(h.value.all).length),1),Mt,e("span",null,d(Object.keys(h.value.specific).length),1),Ft],64)):(n(),i("span",wt,"is not included or has been ignored")),e("button",{"i-ph-x":"","text-sm":"",op25:"","hover:op100":"",onClick:o[7]||(o[7]=a=>{s(r).filepath="",x.value=""})})],2)])):f("",!0),s(r).rule?(n(),i("div",Rt,[e("div",It,[St,Tt,k(m,{name:s(r).rule},null,8,["name"]),Et,e("button",{"i-ph-x":"","text-sm":"",op25:"","hover:op100":"",onClick:o[8]||(o[8]=a=>s(r).rule="")})])])):f("",!0)])):f("",!0),e("div",Dt,[s(r).filepath?(n(),i("div",At,[e("button",{class:R(s(b).viewFileMatchType==="configs"?"btn-action-active":"op50"),"border-none":"","btn-action":"",onClick:o[9]||(o[9]=a=>s(b).viewFileMatchType=s(b).viewFileMatchType==="configs"?"merged":"configs")},Nt,2),Pt,e("button",{class:R(s(b).viewFileMatchType!=="configs"?"btn-action-active":"op50"),"border-none":"","btn-action":"",onClick:o[10]||(o[10]=a=>s(b).viewFileMatchType=s(b).viewFileMatchType==="configs"?"merged":"configs")},Lt,2)])):f("",!0),s(r).filepath&&s(b).viewFileMatchType==="configs"?(n(),i("label",Ut,[e("input",{checked:s(b).showSpecificOnly,type:"checkbox",onChange:o[11]||(o[11]=a=>s(b).showSpecificOnly=!!a.target.checked)},null,40,qt),Kt])):f("",!0),Ht,e("button",{px3:"","btn-action":"",onClick:U}," Expand All "),e("button",{px3:"","btn-action":"",onClick:D}," Collapse All ")]),y.value.length?(n(),i(p,{key:2},[s(r).filepath&&s(b).viewFileMatchType==="merged"?(n(),i(p,{key:0},[e("details",Xt,[e("summary",Yt,[e("div",Zt,[eo,V(" Merged Rules: Common to every file ("+d(Object.keys(h.value.common).length)+" rules) ",1)])]),k(_,{m4:"",rules:h.value.common},null,8,["rules"])]),e("details",to,[e("summary",oo,[e("div",no,[lo,V(" Merged Rules: Specific to matched file ("+d(Object.keys(h.value.specific).length)+" rules) ",1)])]),Object.keys(h.value.specificDisabled).length?(n(),i(p,{key:0},[e("div",so," Disables ("+d(Object.keys(h.value.specificDisabled).length)+") ",1),k(_,{m4:"","get-bind":a=>({class:"op50"}),rules:h.value.specificDisabled},null,8,["rules"])],64)):f("",!0),Object.keys(h.value.specificEnabled).length?(n(),i(p,{key:1},[e("div",io," Enables ("+d(Object.keys(h.value.specificEnabled).length)+") ",1),k(_,{m4:"",rules:h.value.specificEnabled},null,8,["rules"])],64)):f("",!0)])],64)):(n(!0),i(p,{key:1},S(s(O).configs,(a,w)=>{var J;return z((n(),T(l,{key:w,ref_for:!0,ref:I=>{s(A).set(w,I==null?void 0:I.$el)},open:s(F)[w],"onUpdate:open":I=>s(F)[w]=I,payload:s(O),config:a,index:w,filters:s(r),active:!!(s(r).filepath&&a.files),"matched-globs":(J=$.value)==null?void 0:J.globs,onBadgeClick:o[12]||(o[12]=I=>s(r).rule=I)},null,8,["open","onUpdate:open","payload","config","index","filters","active","matched-globs"])),[[oe,y.value.includes(a)&&(!s(r).filepath||!s(b).showSpecificOnly||a.files)]])}),128))],64)):(n(),i(p,{key:1},[Jt,(u=$.value)!=null&&u.globs.length?(n(),i(p,{key:0},[Qt,e("div",Wt,[(n(!0),i(p,null,S($.value.globs,(a,w)=>(n(),T(g,{key:w,glob:a,popup:"configs"},null,8,["glob"]))),128))])],64)):f("",!0)],64))])])}}});export{po as default};
